/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package lei.tqs.services;

import java.util.Arrays;
import java.util.List;
import lei.tqs.domain.DataWeatherBlock;
import org.junit.Test;
import static org.junit.Assert.*;
import org.junit.Before;
import org.junit.runner.RunWith;
import org.mockito.Mockito;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.TestConfiguration;
import org.springframework.boot.test.mock.mockito.MockBean;
import org.springframework.context.annotation.Bean;
import org.springframework.http.HttpEntity;
import org.springframework.http.HttpHeaders;
import org.springframework.http.MediaType;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.web.client.RestClientException;
import org.springframework.web.client.RestTemplate;

@RunWith(SpringRunner.class)
public class DarkSkyUtilTest {
    
    @TestConfiguration
    static class DarkSkyUtilTestContextConfig {
        @Bean
        public DarkSkyUtil DarkSkyUtils() {return new DarkSkyUtil();}
    }
    
    @Autowired
    private DarkSkyUtil darkSkyUtil;
    
    @MockBean
    private RestTemplate restTemplate;
    static HttpHeaders headers = new HttpHeaders();
    static HttpEntity<String> entity;
    static {
        headers.setAccept(Arrays.asList(MediaType.APPLICATION_JSON));
        headers.add("user-agent", "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36");
        entity = new HttpEntity<>("parameters", headers);
    }
    
    @Before
    public void setUp() {
        darkSkyUtil.restTemplate = restTemplate;
        darkSkyUtil.backupAPI.restTemplate = restTemplate;
        Mockito.when(
            restTemplate.getForObject(
               DarkSkyUtil.baseURL+"40.640496,-8.6537841,1556294931?exclude=minutely,hourly,flags&lang=pt&units=si",
               String.class
            )
        ).thenReturn("{\"latitude\":40.640496,\"longitude\":-8.6537841,\"timezone\":\"Europe/Lisbon\",\"currently\":{\"time\":1556294931,\"summary\":\"Limpo\",\"icon\":\"clear-day\",\"precipIntensity\":0,\"precipProbability\":0,\"temperature\":15.27,\"apparentTemperature\":15.27,\"dewPoint\":8.09,\"humidity\":0.62,\"pressure\":1027.54,\"windSpeed\":4.9,\"windGust\":5.49,\"windBearing\":336,\"cloudCover\":0.19,\"uvIndex\":3,\"visibility\":10.01,\"ozone\":325.68},\"daily\":{\"data\":[{\"time\":1556233200,\"summary\":\"Ligeiramente nublado durante todo o dia.\",\"icon\":\"partly-cloudy-day\",\"sunriseTime\":1556257284,\"sunsetTime\":1556306746,\"moonPhase\":0.74,\"precipIntensity\":0.0533,\"precipIntensityMax\":0.2261,\"precipIntensityMaxTime\":1556233200,\"precipProbability\":0.44,\"precipType\":\"rain\",\"temperatureHigh\":16.43,\"temperatureHighTime\":1556287200,\"temperatureLow\":7.43,\"temperatureLowTime\":1556341200,\"apparentTemperatureHigh\":16.43,\"apparentTemperatureHighTime\":1556287200,\"apparentTemperatureLow\":6.08,\"apparentTemperatureLowTime\":1556344800,\"dewPoint\":8.33,\"humidity\":0.73,\"pressure\":1026.33,\"windSpeed\":3.52,\"windGust\":9.18,\"windGustTime\":1556236800,\"windBearing\":337,\"cloudCover\":0.45,\"uvIndex\":6,\"uvIndexTime\":1556287200,\"visibility\":11.25,\"ozone\":344.11,\"temperatureMin\":10.08,\"temperatureMinTime\":1556258400,\"temperatureMax\":16.43,\"temperatureMaxTime\":1556287200,\"apparentTemperatureMin\":10.08,\"apparentTemperatureMinTime\":1556258400,\"apparentTemperatureMax\":16.43,\"apparentTemperatureMaxTime\":1556287200}]},\"offset\":1}");
        Mockito.when(
            restTemplate.getForObject(
               DarkSkyUtil.baseURL+"40.0,-8.0,1556668800?exclude=minutely,hourly,flags&lang=pt&units=si",
               String.class
            )
        ).thenReturn("{\"latitude\":40.640496,\"longitude\":-8.6537841,\"timezone\":\"Europe/Lisbon\",\"currently\":{\"time\":1556294931,\"summary\":\"Limpo\",\"icon\":\"clear-day\",\"precipIntensity\":0,\"precipProbability\":0,\"temperature\":15.27,\"apparentTemperature\":15.27,\"dewPoint\":8.09,\"humidity\":0.62,\"pressure\":1027.54,\"windSpeed\":4.9,\"windGust\":5.49,\"windBearing\":336,\"cloudCover\":0.19,\"uvIndex\":3,\"visibility\":10.01,\"ozone\":325.68},\"hourly\":{\"data\":[{\"time\":1556233200,\"summary\":\"Ligeiramente nublado durante todo o dia.\",\"icon\":\"partly-cloudy-day\",\"sunriseTime\":1556257284,\"sunsetTime\":1556306746,\"moonPhase\":0.74,\"precipIntensity\":0.0533,\"precipIntensityMax\":0.2261,\"precipIntensityMaxTime\":1556233200,\"precipProbability\":0.44,\"precipType\":\"rain\",\"temperatureHigh\":16.43,\"temperatureHighTime\":1556287200,\"temperatureLow\":7.43,\"temperatureLowTime\":1556341200,\"apparentTemperatureHigh\":16.43,\"apparentTemperatureHighTime\":1556287200,\"apparentTemperatureLow\":6.08,\"apparentTemperatureLowTime\":1556344800,\"dewPoint\":8.33,\"humidity\":0.73,\"pressure\":1026.33,\"windSpeed\":3.52,\"windGust\":9.18,\"windGustTime\":1556236800,\"windBearing\":337,\"cloudCover\":0.45,\"uvIndex\":6,\"uvIndexTime\":1556287200,\"visibility\":11.25,\"ozone\":344.11,\"temperatureMin\":10.08,\"temperatureMinTime\":1556258400,\"temperatureMax\":16.43,\"temperatureMaxTime\":1556287200,\"apparentTemperatureMin\":10.08,\"apparentTemperatureMinTime\":1556258400,\"apparentTemperatureMax\":16.43,\"apparentTemperatureMaxTime\":1556287200}]},\"offset\":1}");
        Mockito.when(
            restTemplate.getForObject(
               ApixuUtil.baseURL+"&q=40.0,-8.0&dt=2019-05-01",
               String.class
            )
        ).thenReturn("{\"location\":{\"name\":\"Maria Gomes\",\"region\":\"Coimbra\",\"country\":\"Portugal\",\"lat\":40.0,\"lon\":-8.0,\"tz_id\":\"Europe/Lisbon\",\"localtime_epoch\":1556984037,\"localtime\":\"2019-05-04 16:33\"},\"forecast\":{\"forecastday\":[{\"date\":\"2019-05-01\",\"date_epoch\":1556668800,\"day\":{\"maxtemp_c\":23.2,\"maxtemp_f\":73.8,\"mintemp_c\":10.8,\"mintemp_f\":51.4,\"avgtemp_c\":19.2,\"avgtemp_f\":66.6,\"maxwind_mph\":10.3,\"maxwind_kph\":16.6,\"totalprecip_mm\":0.0,\"totalprecip_in\":0.0,\"avgvis_km\":9.0,\"avgvis_miles\":5.0,\"avghumidity\":73.0,\"condition\":{\"text\":\"Partly cloudy\",\"icon\":\"//cdn.apixu.com/weather/64x64/day/116.png\",\"code\":1003},\"uv\":0.0},\"astro\":{\"sunrise\":\"06:32 AM\",\"sunset\":\"08:26 PM\",\"moonrise\":\"05:12 AM\",\"moonset\":\"05:01 PM\",\"moon_phase\":\"Waning Crescent\",\"moon_illumination\":\"12\"},\"hour\":[{\"time_epoch\":1556665200,\"time\":\"2019-05-01 00:00\",\"temp_c\":12.2,\"temp_f\":54.0,\"is_day\":0,\"condition\":{\"text\":\"Partly cloudy\",\"icon\":\"//cdn.apixu.com/weather/64x64/night/116.png\",\"code\":1003},\"wind_mph\":0.4,\"wind_kph\":0.7,\"wind_degree\":243,\"wind_dir\":\"WSW\",\"pressure_mb\":1014.0,\"pressure_in\":30.4,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":90,\"cloud\":48,\"feelslike_c\":12.2,\"feelslike_f\":54.0,\"windchill_c\":12.2,\"windchill_f\":54.0,\"heatindex_c\":12.2,\"heatindex_f\":54.0,\"dewpoint_c\":10.6,\"dewpoint_f\":51.1,\"will_it_rain\":0,\"chance_of_rain\":\"0\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":10.0,\"vis_miles\":6.0,\"gust_mph\":0.9,\"gust_kph\":1.4},{\"time_epoch\":1556668800,\"time\":\"2019-05-01 01:00\",\"temp_c\":11.7,\"temp_f\":53.1,\"is_day\":0,\"condition\":{\"text\":\"Partly cloudy\",\"icon\":\"//cdn.apixu.com/weather/64x64/night/116.png\",\"code\":1003},\"wind_mph\":0.6,\"wind_kph\":1.0,\"wind_degree\":251,\"wind_dir\":\"WSW\",\"pressure_mb\":1014.0,\"pressure_in\":30.4,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":91,\"cloud\":46,\"feelslike_c\":11.7,\"feelslike_f\":53.1,\"windchill_c\":11.7,\"windchill_f\":53.1,\"heatindex_c\":11.7,\"heatindex_f\":53.1,\"dewpoint_c\":10.4,\"dewpoint_f\":50.7,\"will_it_rain\":0,\"chance_of_rain\":\"1\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":7.3,\"vis_miles\":4.0,\"gust_mph\":1.2,\"gust_kph\":1.9},{\"time_epoch\":1556672400,\"time\":\"2019-05-01 02:00\",\"temp_c\":11.3,\"temp_f\":52.3,\"is_day\":0,\"condition\":{\"text\":\"Mist\",\"icon\":\"//cdn.apixu.com/weather/64x64/night/143.png\",\"code\":1030},\"wind_mph\":0.7,\"wind_kph\":1.2,\"wind_degree\":259,\"wind_dir\":\"W\",\"pressure_mb\":1014.0,\"pressure_in\":30.4,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":93,\"cloud\":44,\"feelslike_c\":11.3,\"feelslike_f\":52.3,\"windchill_c\":11.3,\"windchill_f\":52.3,\"heatindex_c\":11.3,\"heatindex_f\":52.3,\"dewpoint_c\":10.1,\"dewpoint_f\":50.2,\"will_it_rain\":0,\"chance_of_rain\":\"10\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":4.7,\"vis_miles\":2.0,\"gust_mph\":1.5,\"gust_kph\":2.4},{\"time_epoch\":1556676000,\"time\":\"2019-05-01 03:00\",\"temp_c\":10.8,\"temp_f\":51.4,\"is_day\":0,\"condition\":{\"text\":\"Mist\",\"icon\":\"//cdn.apixu.com/weather/64x64/night/143.png\",\"code\":1030},\"wind_mph\":0.9,\"wind_kph\":1.4,\"wind_degree\":267,\"wind_dir\":\"W\",\"pressure_mb\":1014.0,\"pressure_in\":30.4,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":94,\"cloud\":42,\"feelslike_c\":10.8,\"feelslike_f\":51.4,\"windchill_c\":10.8,\"windchill_f\":51.4,\"heatindex_c\":10.8,\"heatindex_f\":51.4,\"dewpoint_c\":9.9,\"dewpoint_f\":49.8,\"will_it_rain\":0,\"chance_of_rain\":\"0\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":2.0,\"vis_miles\":1.0,\"gust_mph\":1.8,\"gust_kph\":2.9},{\"time_epoch\":1556679600,\"time\":\"2019-05-01 04:00\",\"temp_c\":10.9,\"temp_f\":51.6,\"is_day\":0,\"condition\":{\"text\":\"Mist\",\"icon\":\"//cdn.apixu.com/weather/64x64/night/143.png\",\"code\":1030},\"wind_mph\":1.0,\"wind_kph\":1.6,\"wind_degree\":287,\"wind_dir\":\"WNW\",\"pressure_mb\":1013.0,\"pressure_in\":30.4,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":94,\"cloud\":41,\"feelslike_c\":10.9,\"feelslike_f\":51.6,\"windchill_c\":10.9,\"windchill_f\":51.6,\"heatindex_c\":10.9,\"heatindex_f\":51.6,\"dewpoint_c\":10.0,\"dewpoint_f\":50.0,\"will_it_rain\":0,\"chance_of_rain\":\"10\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":4.7,\"vis_miles\":2.0,\"gust_mph\":1.9,\"gust_kph\":3.0},{\"time_epoch\":1556683200,\"time\":\"2019-05-01 05:00\",\"temp_c\":11.0,\"temp_f\":51.8,\"is_day\":0,\"condition\":{\"text\":\"Partly cloudy\",\"icon\":\"//cdn.apixu.com/weather/64x64/night/116.png\",\"code\":1003},\"wind_mph\":1.0,\"wind_kph\":1.7,\"wind_degree\":306,\"wind_dir\":\"NW\",\"pressure_mb\":1013.0,\"pressure_in\":30.4,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":94,\"cloud\":40,\"feelslike_c\":11.0,\"feelslike_f\":51.8,\"windchill_c\":11.0,\"windchill_f\":51.8,\"heatindex_c\":11.0,\"heatindex_f\":51.8,\"dewpoint_c\":10.1,\"dewpoint_f\":50.2,\"will_it_rain\":0,\"chance_of_rain\":\"1\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":7.3,\"vis_miles\":4.0,\"gust_mph\":1.9,\"gust_kph\":3.1},{\"time_epoch\":1556686800,\"time\":\"2019-05-01 06:00\",\"temp_c\":11.1,\"temp_f\":52.0,\"is_day\":0,\"condition\":{\"text\":\"Partly cloudy\",\"icon\":\"//cdn.apixu.com/weather/64x64/night/116.png\",\"code\":1003},\"wind_mph\":1.1,\"wind_kph\":1.8,\"wind_degree\":325,\"wind_dir\":\"NW\",\"pressure_mb\":1013.0,\"pressure_in\":30.4,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":94,\"cloud\":39,\"feelslike_c\":11.1,\"feelslike_f\":52.0,\"windchill_c\":11.1,\"windchill_f\":52.0,\"heatindex_c\":11.1,\"heatindex_f\":52.0,\"dewpoint_c\":10.2,\"dewpoint_f\":50.4,\"will_it_rain\":0,\"chance_of_rain\":\"0\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":10.0,\"vis_miles\":6.0,\"gust_mph\":2.0,\"gust_kph\":3.2},{\"time_epoch\":1556690400,\"time\":\"2019-05-01 07:00\",\"temp_c\":13.7,\"temp_f\":56.6,\"is_day\":1,\"condition\":{\"text\":\"Partly cloudy\",\"icon\":\"//cdn.apixu.com/weather/64x64/day/116.png\",\"code\":1003},\"wind_mph\":2.2,\"wind_kph\":3.5,\"wind_degree\":325,\"wind_dir\":\"NW\",\"pressure_mb\":1013.0,\"pressure_in\":30.4,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":85,\"cloud\":29,\"feelslike_c\":13.7,\"feelslike_f\":56.6,\"windchill_c\":13.7,\"windchill_f\":56.6,\"heatindex_c\":13.7,\"heatindex_f\":56.6,\"dewpoint_c\":10.9,\"dewpoint_f\":51.6,\"will_it_rain\":0,\"chance_of_rain\":\"1\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":10.0,\"vis_miles\":6.0,\"gust_mph\":3.0,\"gust_kph\":4.8},{\"time_epoch\":1556694000,\"time\":\"2019-05-01 08:00\",\"temp_c\":16.2,\"temp_f\":61.2,\"is_day\":1,\"condition\":{\"text\":\"Partly cloudy\",\"icon\":\"//cdn.apixu.com/weather/64x64/day/116.png\",\"code\":1003},\"wind_mph\":3.2,\"wind_kph\":5.2,\"wind_degree\":324,\"wind_dir\":\"NW\",\"pressure_mb\":1013.0,\"pressure_in\":30.4,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":75,\"cloud\":19,\"feelslike_c\":16.2,\"feelslike_f\":61.2,\"windchill_c\":16.2,\"windchill_f\":61.2,\"heatindex_c\":16.2,\"heatindex_f\":61.2,\"dewpoint_c\":11.5,\"dewpoint_f\":52.8,\"will_it_rain\":0,\"chance_of_rain\":\"1\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":10.0,\"vis_miles\":6.0,\"gust_mph\":4.0,\"gust_kph\":6.4},{\"time_epoch\":1556697600,\"time\":\"2019-05-01 09:00\",\"temp_c\":18.8,\"temp_f\":65.8,\"is_day\":1,\"condition\":{\"text\":\"Partly cloudy\",\"icon\":\"//cdn.apixu.com/weather/64x64/day/116.png\",\"code\":1003},\"wind_mph\":4.3,\"wind_kph\":6.8,\"wind_degree\":323,\"wind_dir\":\"NW\",\"pressure_mb\":1013.0,\"pressure_in\":30.4,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":66,\"cloud\":8,\"feelslike_c\":18.8,\"feelslike_f\":65.8,\"windchill_c\":18.8,\"windchill_f\":65.8,\"heatindex_c\":18.8,\"heatindex_f\":65.8,\"dewpoint_c\":12.2,\"dewpoint_f\":54.0,\"will_it_rain\":0,\"chance_of_rain\":\"0\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":10.0,\"vis_miles\":6.0,\"gust_mph\":4.9,\"gust_kph\":7.9},{\"time_epoch\":1556701200,\"time\":\"2019-05-01 10:00\",\"temp_c\":20.3,\"temp_f\":68.5,\"is_day\":1,\"condition\":{\"text\":\"Partly cloudy\",\"icon\":\"//cdn.apixu.com/weather/64x64/day/116.png\",\"code\":1003},\"wind_mph\":5.4,\"wind_kph\":8.6,\"wind_degree\":319,\"wind_dir\":\"NW\",\"pressure_mb\":1013.0,\"pressure_in\":30.4,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":61,\"cloud\":7,\"feelslike_c\":20.3,\"feelslike_f\":68.5,\"windchill_c\":20.3,\"windchill_f\":68.5,\"heatindex_c\":20.8,\"heatindex_f\":69.5,\"dewpoint_c\":12.4,\"dewpoint_f\":54.4,\"will_it_rain\":0,\"chance_of_rain\":\"1\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":10.0,\"vis_miles\":6.0,\"gust_mph\":6.2,\"gust_kph\":10.0},{\"time_epoch\":1556704800,\"time\":\"2019-05-01 11:00\",\"temp_c\":21.7,\"temp_f\":71.1,\"is_day\":1,\"condition\":{\"text\":\"Partly cloudy\",\"icon\":\"//cdn.apixu.com/weather/64x64/day/116.png\",\"code\":1003},\"wind_mph\":6.5,\"wind_kph\":10.4,\"wind_degree\":315,\"wind_dir\":\"NW\",\"pressure_mb\":1013.0,\"pressure_in\":30.4,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":57,\"cloud\":6,\"feelslike_c\":21.7,\"feelslike_f\":71.1,\"windchill_c\":21.7,\"windchill_f\":71.1,\"heatindex_c\":22.9,\"heatindex_f\":73.2,\"dewpoint_c\":12.7,\"dewpoint_f\":54.8,\"will_it_rain\":0,\"chance_of_rain\":\"1\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":10.0,\"vis_miles\":6.0,\"gust_mph\":7.5,\"gust_kph\":12.0},{\"time_epoch\":1556708400,\"time\":\"2019-05-01 12:00\",\"temp_c\":23.2,\"temp_f\":73.8,\"is_day\":1,\"condition\":{\"text\":\"Partly cloudy\",\"icon\":\"//cdn.apixu.com/weather/64x64/day/116.png\",\"code\":1003},\"wind_mph\":7.6,\"wind_kph\":12.2,\"wind_degree\":311,\"wind_dir\":\"NW\",\"pressure_mb\":1013.0,\"pressure_in\":30.4,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":52,\"cloud\":4,\"feelslike_c\":24.9,\"feelslike_f\":76.8,\"windchill_c\":23.2,\"windchill_f\":73.8,\"heatindex_c\":24.9,\"heatindex_f\":76.8,\"dewpoint_c\":12.9,\"dewpoint_f\":55.2,\"will_it_rain\":0,\"chance_of_rain\":\"0\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":10.0,\"vis_miles\":6.0,\"gust_mph\":8.7,\"gust_kph\":14.0},{\"time_epoch\":1556712000,\"time\":\"2019-05-01 13:00\",\"temp_c\":23.2,\"temp_f\":73.8,\"is_day\":1,\"condition\":{\"text\":\"Partly cloudy\",\"icon\":\"//cdn.apixu.com/weather/64x64/day/116.png\",\"code\":1003},\"wind_mph\":8.5,\"wind_kph\":13.7,\"wind_degree\":312,\"wind_dir\":\"NW\",\"pressure_mb\":1012.0,\"pressure_in\":30.4,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":52,\"cloud\":3,\"feelslike_c\":24.9,\"feelslike_f\":76.8,\"windchill_c\":23.2,\"windchill_f\":73.8,\"heatindex_c\":24.9,\"heatindex_f\":76.8,\"dewpoint_c\":12.7,\"dewpoint_f\":54.9,\"will_it_rain\":0,\"chance_of_rain\":\"1\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":10.0,\"vis_miles\":6.0,\"gust_mph\":9.8,\"gust_kph\":15.7},{\"time_epoch\":1556715600,\"time\":\"2019-05-01 14:00\",\"temp_c\":23.2,\"temp_f\":73.8,\"is_day\":1,\"condition\":{\"text\":\"Partly cloudy\",\"icon\":\"//cdn.apixu.com/weather/64x64/day/116.png\",\"code\":1003},\"wind_mph\":9.4,\"wind_kph\":15.1,\"wind_degree\":312,\"wind_dir\":\"NW\",\"pressure_mb\":1012.0,\"pressure_in\":30.3,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":51,\"cloud\":3,\"feelslike_c\":24.8,\"feelslike_f\":76.7,\"windchill_c\":23.2,\"windchill_f\":73.8,\"heatindex_c\":24.8,\"heatindex_f\":76.7,\"dewpoint_c\":12.5,\"dewpoint_f\":54.5,\"will_it_rain\":0,\"chance_of_rain\":\"1\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":10.0,\"vis_miles\":6.0,\"gust_mph\":10.8,\"gust_kph\":17.4},{\"time_epoch\":1556719200,\"time\":\"2019-05-01 15:00\",\"temp_c\":23.2,\"temp_f\":73.8,\"is_day\":1,\"condition\":{\"text\":\"Partly cloudy\",\"icon\":\"//cdn.apixu.com/weather/64x64/day/116.png\",\"code\":1003},\"wind_mph\":10.3,\"wind_kph\":16.6,\"wind_degree\":313,\"wind_dir\":\"NW\",\"pressure_mb\":1011.0,\"pressure_in\":30.3,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":50,\"cloud\":2,\"feelslike_c\":24.8,\"feelslike_f\":76.6,\"windchill_c\":23.2,\"windchill_f\":73.8,\"heatindex_c\":24.8,\"heatindex_f\":76.6,\"dewpoint_c\":12.3,\"dewpoint_f\":54.1,\"will_it_rain\":0,\"chance_of_rain\":\"0\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":10.0,\"vis_miles\":6.0,\"gust_mph\":11.9,\"gust_kph\":19.1},{\"time_epoch\":1556722800,\"time\":\"2019-05-01 16:00\",\"temp_c\":22.1,\"temp_f\":71.8,\"is_day\":1,\"condition\":{\"text\":\"Partly cloudy\",\"icon\":\"//cdn.apixu.com/weather/64x64/day/116.png\",\"code\":1003},\"wind_mph\":9.0,\"wind_kph\":14.5,\"wind_degree\":313,\"wind_dir\":\"NW\",\"pressure_mb\":1011.0,\"pressure_in\":30.3,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":53,\"cloud\":1,\"feelslike_c\":23.2,\"feelslike_f\":73.7,\"windchill_c\":22.1,\"windchill_f\":71.8,\"heatindex_c\":23.2,\"heatindex_f\":73.7,\"dewpoint_c\":12.1,\"dewpoint_f\":53.8,\"will_it_rain\":0,\"chance_of_rain\":\"1\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":10.0,\"vis_miles\":6.0,\"gust_mph\":10.6,\"gust_kph\":17.0},{\"time_epoch\":1556726400,\"time\":\"2019-05-01 17:00\",\"temp_c\":21.0,\"temp_f\":69.8,\"is_day\":1,\"condition\":{\"text\":\"Sunny\",\"icon\":\"//cdn.apixu.com/weather/64x64/day/113.png\",\"code\":1000},\"wind_mph\":7.8,\"wind_kph\":12.5,\"wind_degree\":314,\"wind_dir\":\"NW\",\"pressure_mb\":1011.0,\"pressure_in\":30.3,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":56,\"cloud\":1,\"feelslike_c\":21.0,\"feelslike_f\":69.8,\"windchill_c\":21.0,\"windchill_f\":69.8,\"heatindex_c\":21.5,\"heatindex_f\":70.8,\"dewpoint_c\":12.0,\"dewpoint_f\":53.5,\"will_it_rain\":0,\"chance_of_rain\":\"0\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":10.0,\"vis_miles\":6.0,\"gust_mph\":9.3,\"gust_kph\":15.0},{\"time_epoch\":1556730000,\"time\":\"2019-05-01 18:00\",\"temp_c\":19.9,\"temp_f\":67.8,\"is_day\":1,\"condition\":{\"text\":\"Sunny\",\"icon\":\"//cdn.apixu.com/weather/64x64/day/113.png\",\"code\":1000},\"wind_mph\":6.5,\"wind_kph\":10.4,\"wind_degree\":315,\"wind_dir\":\"NW\",\"pressure_mb\":1011.0,\"pressure_in\":30.3,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":60,\"cloud\":0,\"feelslike_c\":19.9,\"feelslike_f\":67.8,\"windchill_c\":19.9,\"windchill_f\":67.8,\"heatindex_c\":19.9,\"heatindex_f\":67.8,\"dewpoint_c\":11.8,\"dewpoint_f\":53.2,\"will_it_rain\":0,\"chance_of_rain\":\"0\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":10.0,\"vis_miles\":6.0,\"gust_mph\":8.1,\"gust_kph\":13.0},{\"time_epoch\":1556733600,\"time\":\"2019-05-01 19:00\",\"temp_c\":19.2,\"temp_f\":66.6,\"is_day\":1,\"condition\":{\"text\":\"Sunny\",\"icon\":\"//cdn.apixu.com/weather/64x64/day/113.png\",\"code\":1000},\"wind_mph\":4.7,\"wind_kph\":7.6,\"wind_degree\":305,\"wind_dir\":\"NW\",\"pressure_mb\":1011.0,\"pressure_in\":30.3,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":67,\"cloud\":1,\"feelslike_c\":19.2,\"feelslike_f\":66.6,\"windchill_c\":19.2,\"windchill_f\":66.6,\"heatindex_c\":20.2,\"heatindex_f\":68.4,\"dewpoint_c\":11.8,\"dewpoint_f\":53.2,\"will_it_rain\":0,\"chance_of_rain\":\"0\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":10.0,\"vis_miles\":6.0,\"gust_mph\":6.0,\"gust_kph\":9.7},{\"time_epoch\":1556737200,\"time\":\"2019-05-01 20:00\",\"temp_c\":18.6,\"temp_f\":65.4,\"is_day\":1,\"condition\":{\"text\":\"Partly cloudy\",\"icon\":\"//cdn.apixu.com/weather/64x64/day/116.png\",\"code\":1003},\"wind_mph\":2.9,\"wind_kph\":4.7,\"wind_degree\":295,\"wind_dir\":\"WNW\",\"pressure_mb\":1012.0,\"pressure_in\":30.3,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":75,\"cloud\":2,\"feelslike_c\":18.6,\"feelslike_f\":65.4,\"windchill_c\":18.6,\"windchill_f\":65.4,\"heatindex_c\":20.6,\"heatindex_f\":69.0,\"dewpoint_c\":11.8,\"dewpoint_f\":53.2,\"will_it_rain\":0,\"chance_of_rain\":\"1\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":10.0,\"vis_miles\":6.0,\"gust_mph\":4.0,\"gust_kph\":6.5},{\"time_epoch\":1556740800,\"time\":\"2019-05-01 21:00\",\"temp_c\":17.9,\"temp_f\":64.2,\"is_day\":0,\"condition\":{\"text\":\"Partly cloudy\",\"icon\":\"//cdn.apixu.com/weather/64x64/night/116.png\",\"code\":1003},\"wind_mph\":1.1,\"wind_kph\":1.8,\"wind_degree\":285,\"wind_dir\":\"WNW\",\"pressure_mb\":1012.0,\"pressure_in\":30.4,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":82,\"cloud\":3,\"feelslike_c\":17.9,\"feelslike_f\":64.2,\"windchill_c\":17.9,\"windchill_f\":64.2,\"heatindex_c\":20.9,\"heatindex_f\":69.6,\"dewpoint_c\":11.8,\"dewpoint_f\":53.2,\"will_it_rain\":0,\"chance_of_rain\":\"0\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":10.0,\"vis_miles\":6.0,\"gust_mph\":2.0,\"gust_kph\":3.2},{\"time_epoch\":1556744400,\"time\":\"2019-05-01 22:00\",\"temp_c\":16.6,\"temp_f\":61.9,\"is_day\":0,\"condition\":{\"text\":\"Partly cloudy\",\"icon\":\"//cdn.apixu.com/weather/64x64/night/116.png\",\"code\":1003},\"wind_mph\":1.6,\"wind_kph\":2.6,\"wind_degree\":206,\"wind_dir\":\"SSW\",\"pressure_mb\":1012.0,\"pressure_in\":30.4,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":82,\"cloud\":5,\"feelslike_c\":16.8,\"feelslike_f\":62.2,\"windchill_c\":16.8,\"windchill_f\":62.2,\"heatindex_c\":18.6,\"heatindex_f\":65.5,\"dewpoint_c\":11.6,\"dewpoint_f\":52.8,\"will_it_rain\":0,\"chance_of_rain\":\"1\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":10.0,\"vis_miles\":6.0,\"gust_mph\":3.2,\"gust_kph\":5.2},{\"time_epoch\":1556748000,\"time\":\"2019-05-01 23:00\",\"temp_c\":15.4,\"temp_f\":59.7,\"is_day\":0,\"condition\":{\"text\":\"Partly cloudy\",\"icon\":\"//cdn.apixu.com/weather/64x64/night/116.png\",\"code\":1003},\"wind_mph\":2.2,\"wind_kph\":3.5,\"wind_degree\":127,\"wind_dir\":\"SE\",\"pressure_mb\":1012.0,\"pressure_in\":30.4,\"precip_mm\":0.0,\"precip_in\":0.0,\"humidity\":82,\"cloud\":7,\"feelslike_c\":15.7,\"feelslike_f\":60.3,\"windchill_c\":15.7,\"windchill_f\":60.3,\"heatindex_c\":16.4,\"heatindex_f\":61.5,\"dewpoint_c\":11.3,\"dewpoint_f\":52.4,\"will_it_rain\":0,\"chance_of_rain\":\"1\",\"will_it_snow\":0,\"chance_of_snow\":\"0\",\"vis_km\":10.0,\"vis_miles\":6.0,\"gust_mph\":4.4,\"gust_kph\":7.1}]}]}}");
        Mockito.when(
            restTemplate.getForObject(
               DarkSkyUtil.baseURL+"0.0,0.0,1556668800?exclude=minutely,hourly,flags&lang=pt&units=si",
               String.class
            )
        ).thenThrow(new RestClientException(""));
        Mockito.when(
            restTemplate.getForObject(
               ApixuUtil.baseURL+"&q=0.0,0.0&dt=2019-05-01",
               String.class
            )
        ).thenThrow(new RestClientException(""));
    }
    
    @Test
    public void testgetWeatherFromCoordinates() {
        List<DataWeatherBlock> result = darkSkyUtil.getWeatherFromCoordinates(40.640496,-8.6537841,1556294931 ,1556294931);
        assertNotEquals(0, result.size());
        result.forEach(b -> assertNotEquals(null, b));
    }
    
    @Test
    public void testgetWeatherFromIncorrectCoordinates1() {
        List<DataWeatherBlock> result = darkSkyUtil.getWeatherFromCoordinates(-91, -91,1556294931 ,1556294931);
        assertEquals(0, result.size());
    }
    
    @Test
    public void testgetWeatherFromIncorrectCoordinates2() {
        List<DataWeatherBlock> result = darkSkyUtil.getWeatherFromCoordinates(91, 91,1556294931 ,1556294931);
        assertEquals(0, result.size());
    }
    
    @Test
    public void testgetWeatherFromIncorrectCoordinates3() {
        List<DataWeatherBlock> result = darkSkyUtil.getWeatherFromCoordinates(90, 181,1556294931 ,1556294931);
        assertEquals(0, result.size());
    }
    
    @Test
    public void testgetWeatherFromIncorrectCoordinates4() {
        List<DataWeatherBlock> result = darkSkyUtil.getWeatherFromCoordinates(90, -181,1556294931 ,1556294931);
        assertEquals(0, result.size());
    }
    
    @Test
    public void testgetWeatherFromCoordinatesFromBackupAPI() {
        List<DataWeatherBlock> result = darkSkyUtil.getWeatherFromCoordinates(40,-8,1556668800 ,1556668800);
        assertNotEquals(0, result.size());
        result.forEach(b -> assertNotEquals(null, b));
    }
    
    @Test
    public void testRestClientException() {
        List<DataWeatherBlock> result = darkSkyUtil.getWeatherFromCoordinates(0.0, 0.0, 1556668800, 1556668800);
        assertEquals(0, result.size());
    }
}
